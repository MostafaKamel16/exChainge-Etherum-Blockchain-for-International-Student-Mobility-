/*!
 * MIT License
 * 
 * Copyright (c) 2021 Yoav Niran
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.rpldy=t(require("react"),require("react-dom")):e.rpldy=t(e.react,e["react-dom"])}(window,(function(e,t){return function(e){function t(t){for(var r,s,u=t[0],i=t[1],d=t[2],l=0,f=[];l<u.length;l++)s=u[l],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&f.push(o[s][0]),o[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);for(c&&c(t);f.length;)f.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,u=1;u<n.length;u++){var i=n[u];0!==o[i]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={main:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var u=window.webpackJsonprpldy=window.webpackJsonprpldy||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var c=i;return a.push(["MIuT","polyfills"]),n()}({DVTP:function(e,t){e.exports=function(){return!0}},Lrr1:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return i}));var r=n("mHo/");const o=Symbol.for("_rpldy-version_"),a=()=>"0.14.2",s=()=>(Object(r.hasWindow)()?window:e)[o],u=()=>{(Object(r.hasWindow)()?window:e)[o]=a()},i=()=>{const e=s();return!!e&&e!==a()}}).call(this,n("8oxB"))},MIuT:function(e,t,n){"use strict";n.r(t),n.d(t,"chunkedSender",(function(){return a})),n.d(t,"lifeEvents",(function(){return s})),n.d(t,"mockSender",(function(){return u})),n.d(t,"retry",(function(){return d})),n.d(t,"safeStorage",(function(){return c})),n.d(t,"sender",(function(){return r})),n.d(t,"shared",(function(){return T})),n.d(t,"simpleState",(function(){return o})),n.d(t,"tusSender",(function(){return l})),n.d(t,"uploader",(function(){return i})),n.d(t,"chunkedUploady",(function(){return g})),n.d(t,"retryHooks",(function(){return h})),n.d(t,"sharedUi",(function(){return f})),n.d(t,"tusUploady",(function(){return b})),n.d(t,"uploadButton",(function(){return m})),n.d(t,"uploadDropZone",(function(){return S})),n.d(t,"uploadPaste",(function(){return E})),n.d(t,"uploadPreview",(function(){return v})),n.d(t,"uploadUrlInput",(function(){return O})),n.d(t,"uploady",(function(){return p}));var r={};n.r(r),n.d(r,"default",(function(){return U})),n.d(r,"send",(function(){return w})),n.d(r,"getXhrSend",(function(){return D})),n.d(r,"XHR_SENDER_TYPE",(function(){return y})),n.d(r,"MissingUrlError",(function(){return I}));var o={};n.r(o),n.d(o,"default",(function(){return K})),n.d(o,"createState",(function(){return K})),n.d(o,"unwrap",(function(){return V})),n.d(o,"isProxy",(function(){return M})),n.d(o,"isProxiable",(function(){return q}));var a={};n.r(a),n.d(a,"default",(function(){return fe})),n.d(a,"CHUNK_EVENTS",(function(){return X})),n.d(a,"CHUNKING_SUPPORT",(function(){return N})),n.d(a,"CHUNKED_SENDER_TYPE",(function(){return Q})),n.d(a,"CHUNKED_DEFAULT_OPTIONS",(function(){return k})),n.d(a,"getChunkedEnhancer",(function(){return le})),n.d(a,"createChunkedSender",(function(){return ce})),n.d(a,"getChunkDataFromFile",(function(){return F}));var s={};n.r(s),n.d(s,"default",(function(){return Pe})),n.d(s,"addLife",(function(){return Pe})),n.d(s,"isLE",(function(){return ve})),n.d(s,"createLifePack",(function(){return De}));var u={};n.r(u),n.d(u,"default",(function(){return Fe})),n.d(u,"MOCK_SENDER_TYPE",(function(){return we})),n.d(u,"createMockSender",(function(){return je})),n.d(u,"getMockSenderEnhancer",(function(){return Ne}));var i={};n.r(i),n.d(i,"default",(function(){return At})),n.d(i,"UPLOADER_EVENTS",(function(){return Be})),n.d(i,"DEFAULT_OPTIONS",(function(){return gt})),n.d(i,"composeEnhancers",(function(){return It})),n.d(i,"createUploader",(function(){return yt})),n.d(i,"send",(function(){return w})),n.d(i,"getXhrSend",(function(){return D})),n.d(i,"XHR_SENDER_TYPE",(function(){return y})),n.d(i,"MissingUrlError",(function(){return I}));var d={};n.r(d),n.d(d,"default",(function(){return Dt})),n.d(d,"retryEnhancer",(function(){return Dt})),n.d(d,"RETRY_EVENT",(function(){return _t})),n.d(d,"RETRY_EXT",(function(){return Lt}));var c={};n.r(c),n.d(c,"safeLocalStorage",(function(){return Ut})),n.d(c,"safeSessionStorage",(function(){return kt}));var l={};n.r(l),n.d(l,"CHUNKING_SUPPORT",(function(){return N})),n.d(l,"TUS_SENDER_TYPE",(function(){return $t})),n.d(l,"getTusEnhancer",(function(){return bn})),n.d(l,"clearResumables",(function(){return xt})),n.d(l,"TUS_EXT",(function(){return qt})),n.d(l,"default",(function(){return mn}));var f={};n.r(f),n.d(f,"useBatchAddListener",(function(){return kn})),n.d(f,"useBatchStartListener",(function(){return jn})),n.d(f,"useBatchProgressListener",(function(){return xn})),n.d(f,"useBatchFinishListener",(function(){return Nn})),n.d(f,"useBatchCancelledListener",(function(){return Fn})),n.d(f,"useBatchAbortListener",(function(){return Bn})),n.d(f,"useItemStartListener",(function(){return Hn})),n.d(f,"useItemFinishListener",(function(){return Mn})),n.d(f,"useItemProgressListener",(function(){return Wn})),n.d(f,"useItemCancelListener",(function(){return qn})),n.d(f,"useItemErrorListener",(function(){return $n})),n.d(f,"useItemAbortListener",(function(){return zn})),n.d(f,"useItemFinalizeListener",(function(){return Gn})),n.d(f,"useRequestPreSend",(function(){return Vn})),n.d(f,"useAllAbortListener",(function(){return Kn})),n.d(f,"generateUploaderEventHook",(function(){return Pn})),n.d(f,"generateUploaderEventHookWithState",(function(){return Cn})),n.d(f,"logWarning",(function(){return Dn})),n.d(f,"markAsUploadOptionsComponent",(function(){return wn})),n.d(f,"getIsUploadOptionsComponent",(function(){return Un})),n.d(f,"assertContext",(function(){return Ln})),n.d(f,"useUploadOptions",(function(){return Xn})),n.d(f,"useAbortItem",(function(){return Qn})),n.d(f,"useAbortBatch",(function(){return Yn})),n.d(f,"useAbortAll",(function(){return Jn})),n.d(f,"NoDomUploady",(function(){return Zn})),n.d(f,"UploadyContext",(function(){return An})),n.d(f,"createContextApi",(function(){return In})),n.d(f,"withRequestPreSendUpdate",(function(){return er})),n.d(f,"useUploadyContext",(function(){return _n})),n.d(f,"useUploady",(function(){return _n})),n.d(f,"getUploadyVersion",(function(){return yn.c}));var p={};n.r(p),n.d(p,"default",(function(){return ir})),n.d(p,"useFileInput",(function(){return ur})),n.d(p,"Uploady",(function(){return ar})),n.d(p,"UPLOADER_EVENTS",(function(){return Be})),n.d(p,"DEFAULT_OPTIONS",(function(){return gt})),n.d(p,"composeEnhancers",(function(){return It})),n.d(p,"createUploader",(function(){return yt})),n.d(p,"send",(function(){return w})),n.d(p,"getXhrSend",(function(){return D})),n.d(p,"XHR_SENDER_TYPE",(function(){return y})),n.d(p,"MissingUrlError",(function(){return I})),n.d(p,"useBatchAddListener",(function(){return kn})),n.d(p,"useBatchStartListener",(function(){return jn})),n.d(p,"useBatchProgressListener",(function(){return xn})),n.d(p,"useBatchFinishListener",(function(){return Nn})),n.d(p,"useBatchCancelledListener",(function(){return Fn})),n.d(p,"useBatchAbortListener",(function(){return Bn})),n.d(p,"useItemStartListener",(function(){return Hn})),n.d(p,"useItemFinishListener",(function(){return Mn})),n.d(p,"useItemProgressListener",(function(){return Wn})),n.d(p,"useItemCancelListener",(function(){return qn})),n.d(p,"useItemErrorListener",(function(){return $n})),n.d(p,"useItemAbortListener",(function(){return zn})),n.d(p,"useItemFinalizeListener",(function(){return Gn})),n.d(p,"useRequestPreSend",(function(){return Vn})),n.d(p,"useAllAbortListener",(function(){return Kn})),n.d(p,"generateUploaderEventHook",(function(){return Pn})),n.d(p,"generateUploaderEventHookWithState",(function(){return Cn})),n.d(p,"logWarning",(function(){return Dn})),n.d(p,"markAsUploadOptionsComponent",(function(){return wn})),n.d(p,"getIsUploadOptionsComponent",(function(){return Un})),n.d(p,"assertContext",(function(){return Ln})),n.d(p,"useUploadOptions",(function(){return Xn})),n.d(p,"useAbortItem",(function(){return Qn})),n.d(p,"useAbortBatch",(function(){return Yn})),n.d(p,"useAbortAll",(function(){return Jn})),n.d(p,"NoDomUploady",(function(){return Zn})),n.d(p,"UploadyContext",(function(){return An})),n.d(p,"createContextApi",(function(){return In})),n.d(p,"withRequestPreSendUpdate",(function(){return er})),n.d(p,"useUploadyContext",(function(){return _n})),n.d(p,"useUploady",(function(){return _n})),n.d(p,"getUploadyVersion",(function(){return yn.c})),n.d(p,"FILE_STATES",(function(){return T.FILE_STATES})),n.d(p,"BATCH_STATES",(function(){return T.BATCH_STATES}));var g={};n.r(g),n.d(g,"default",(function(){return fr})),n.d(g,"ChunkedUploady",(function(){return dr})),n.d(g,"CHUNK_EVENTS",(function(){return X})),n.d(g,"useFileInput",(function(){return ur})),n.d(g,"Uploady",(function(){return ar})),n.d(g,"UPLOADER_EVENTS",(function(){return Be})),n.d(g,"DEFAULT_OPTIONS",(function(){return gt})),n.d(g,"composeEnhancers",(function(){return It})),n.d(g,"createUploader",(function(){return yt})),n.d(g,"send",(function(){return w})),n.d(g,"getXhrSend",(function(){return D})),n.d(g,"XHR_SENDER_TYPE",(function(){return y})),n.d(g,"MissingUrlError",(function(){return I})),n.d(g,"useBatchAddListener",(function(){return kn})),n.d(g,"useBatchStartListener",(function(){return jn})),n.d(g,"useBatchProgressListener",(function(){return xn})),n.d(g,"useBatchFinishListener",(function(){return Nn})),n.d(g,"useBatchCancelledListener",(function(){return Fn})),n.d(g,"useBatchAbortListener",(function(){return Bn})),n.d(g,"useItemStartListener",(function(){return Hn})),n.d(g,"useItemFinishListener",(function(){return Mn})),n.d(g,"useItemProgressListener",(function(){return Wn})),n.d(g,"useItemCancelListener",(function(){return qn})),n.d(g,"useItemErrorListener",(function(){return $n})),n.d(g,"useItemAbortListener",(function(){return zn})),n.d(g,"useItemFinalizeListener",(function(){return Gn})),n.d(g,"useRequestPreSend",(function(){return Vn})),n.d(g,"useAllAbortListener",(function(){return Kn})),n.d(g,"generateUploaderEventHook",(function(){return Pn})),n.d(g,"generateUploaderEventHookWithState",(function(){return Cn})),n.d(g,"logWarning",(function(){return Dn})),n.d(g,"markAsUploadOptionsComponent",(function(){return wn})),n.d(g,"getIsUploadOptionsComponent",(function(){return Un})),n.d(g,"assertContext",(function(){return Ln})),n.d(g,"useUploadOptions",(function(){return Xn})),n.d(g,"useAbortItem",(function(){return Qn})),n.d(g,"useAbortBatch",(function(){return Yn})),n.d(g,"useAbortAll",(function(){return Jn})),n.d(g,"NoDomUploady",(function(){return Zn})),n.d(g,"UploadyContext",(function(){return An})),n.d(g,"createContextApi",(function(){return In})),n.d(g,"withRequestPreSendUpdate",(function(){return er})),n.d(g,"useUploadyContext",(function(){return _n})),n.d(g,"useUploady",(function(){return _n})),n.d(g,"getUploadyVersion",(function(){return yn.c})),n.d(g,"FILE_STATES",(function(){return T.FILE_STATES})),n.d(g,"BATCH_STATES",(function(){return T.BATCH_STATES})),n.d(g,"useChunkStartListener",(function(){return cr})),n.d(g,"useChunkFinishListener",(function(){return lr}));var h={};n.r(h),n.d(h,"default",(function(){return mr})),n.d(h,"RETRY_EVENT",(function(){return _t})),n.d(h,"retryEnhancer",(function(){return Dt})),n.d(h,"useRetry",(function(){return gr})),n.d(h,"useBatchRetry",(function(){return hr})),n.d(h,"useRetryListener",(function(){return br}));var b={};n.r(b),n.d(b,"default",(function(){return vr})),n.d(b,"TusUploady",(function(){return Sr})),n.d(b,"useClearResumableStore",(function(){return Er})),n.d(b,"useFileInput",(function(){return ur})),n.d(b,"Uploady",(function(){return ar})),n.d(b,"UPLOADER_EVENTS",(function(){return Be})),n.d(b,"DEFAULT_OPTIONS",(function(){return gt})),n.d(b,"composeEnhancers",(function(){return It})),n.d(b,"createUploader",(function(){return yt})),n.d(b,"send",(function(){return w})),n.d(b,"getXhrSend",(function(){return D})),n.d(b,"XHR_SENDER_TYPE",(function(){return y})),n.d(b,"MissingUrlError",(function(){return I})),n.d(b,"useBatchAddListener",(function(){return kn})),n.d(b,"useBatchStartListener",(function(){return jn})),n.d(b,"useBatchProgressListener",(function(){return xn})),n.d(b,"useBatchFinishListener",(function(){return Nn})),n.d(b,"useBatchCancelledListener",(function(){return Fn})),n.d(b,"useBatchAbortListener",(function(){return Bn})),n.d(b,"useItemStartListener",(function(){return Hn})),n.d(b,"useItemFinishListener",(function(){return Mn})),n.d(b,"useItemProgressListener",(function(){return Wn})),n.d(b,"useItemCancelListener",(function(){return qn})),n.d(b,"useItemErrorListener",(function(){return $n})),n.d(b,"useItemAbortListener",(function(){return zn})),n.d(b,"useItemFinalizeListener",(function(){return Gn})),n.d(b,"useRequestPreSend",(function(){return Vn})),n.d(b,"useAllAbortListener",(function(){return Kn})),n.d(b,"generateUploaderEventHook",(function(){return Pn})),n.d(b,"generateUploaderEventHookWithState",(function(){return Cn})),n.d(b,"logWarning",(function(){return Dn})),n.d(b,"markAsUploadOptionsComponent",(function(){return wn})),n.d(b,"getIsUploadOptionsComponent",(function(){return Un})),n.d(b,"assertContext",(function(){return Ln})),n.d(b,"useUploadOptions",(function(){return Xn})),n.d(b,"useAbortItem",(function(){return Qn})),n.d(b,"useAbortBatch",(function(){return Yn})),n.d(b,"useAbortAll",(function(){return Jn})),n.d(b,"NoDomUploady",(function(){return Zn})),n.d(b,"UploadyContext",(function(){return An})),n.d(b,"createContextApi",(function(){return In})),n.d(b,"withRequestPreSendUpdate",(function(){return er})),n.d(b,"useUploadyContext",(function(){return _n})),n.d(b,"useUploady",(function(){return _n})),n.d(b,"getUploadyVersion",(function(){return yn.c})),n.d(b,"FILE_STATES",(function(){return T.FILE_STATES})),n.d(b,"BATCH_STATES",(function(){return T.BATCH_STATES}));var m={};n.r(m),n.d(m,"default",(function(){return yr})),n.d(m,"UploadButton",(function(){return Tr})),n.d(m,"asUploadButton",(function(){return Or}));var S={};n.r(S),n.d(S,"default",(function(){return _r})),n.d(S,"UploadDropZone",(function(){return Lr}));var E={};n.r(E),n.d(E,"withPasteUpload",(function(){return Cr})),n.d(E,"default",(function(){return Ur})),n.d(E,"usePasteUpload",(function(){return wr}));var v={};n.r(v),n.d(v,"PREVIEW_TYPES",(function(){return kr})),n.d(v,"default",(function(){return Mr})),n.d(v,"UploadPreview",(function(){return Hr}));var O={};n.r(O),n.d(O,"default",(function(){return zr})),n.d(O,"UploadUrlInput",(function(){return $r}));var T=n("mHo/");const y="rpldy-sender";class I extends Error{constructor(e){super(e+" didn't receive upload URL"),this.name="MissingUrlError"}}const A=(e,t,...n)=>{"set"in e?e.set(t,...n):("delete"in e&&e.delete(t),e.append(t,...n))};var L=(e,t)=>{const n=new FormData;return t.params&&Object.entries(t.params).forEach(([e,t])=>A(n,e,t)),((e,t,n)=>{const r=1===t.length;t.forEach((t,o)=>{const a=r?n.paramName:Object(T.isFunction)(n.formatGroupParamName)?n.formatGroupParamName(o,n.paramName):`${n.paramName}[${o}]`;t.file?A(e,a,t.file,t.file.name):t.url&&A(e,a,t.url)})})(n,e,t),n};const _=[200,201,202,203,204],R=(e,t,n,r,o)=>{let a;const s=null!=o&&o.getRequestData?o.getRequestData(e,n):((e,t)=>{let n;if(t.sendWithFormData)T.logger.debugLog(`uploady.sender: sending ${e.length} item(s) as form data`),n=L(e,t);else{if(e.length>1)throw new Error("XHR Sender - Request without form data can only contain 1 item. received "+e.length);const t=e[0];T.logger.debugLog(`uploady.sender: sending item ${t.id} as request body`),n=t.file||t.url}return n})(e,n),u=(o=t,u=s,i)=>{i=Object(T.merge)({...Object(T.pick)(n,["method","headers","withCredentials"]),preSend:t=>{t.upload.onprogress=t=>{t.lengthComputable&&r&&r(t,e.slice())}}},i);const d=Object(T.request)(o,u,i);return a=d.xhr,d},i=null!=o&&o.preRequestHandler?o.preRequestHandler(u,e,t,n,r,o):u();return{url:t,count:e.length,pXhr:i,getXhr:()=>a,aborted:!1}},C=(e,t,n)=>{let r=e;const o=null==t?void 0:t["content-type"];if(n.forceJsonResponse||null!=o&&o.includes("json"))try{r=JSON.parse(e)}catch{}return r},P=(e,t)=>e.pXhr.then(e=>{var n,r;let o,a,s;T.logger.debugLog("uploady.sender: received upload response ",e),o=~_.indexOf(e.status)?T.FILE_STATES.FINISHED:T.FILE_STATES.ERROR,s=e.status;const u=Object(T.parseResponseHeaders)(e);return a={data:null!==(n=null===(r=t.formatServerResponse)||void 0===r?void 0:r.call(t,e.response,s,u))&&void 0!==n?n:C(e.response,u,t),headers:u},{status:s,state:o,response:a}}).catch(t=>{let n,r;return e.aborted?(n=T.FILE_STATES.ABORTED,r="aborted"):(T.logger.debugLog("uploady.sender: upload failed: ",t),n=T.FILE_STATES.ERROR,r=t),{error:!0,state:n,response:r,status:0}});var D=e=>(t,n,r,o)=>{if(!n)throw new I(y);T.logger.debugLog("uploady.sender: sending file: ",{items:t,url:n,options:r});const a=R(t,n,r,o,e);return{request:P(a,r),abort:()=>(e=>{let t=!1;const{aborted:n,getXhr:r}=e,o=r();return!n&&o&&o.readyState&&4!==o.readyState&&(T.logger.debugLog(`uploady.sender: cancelling request with ${e.count} items to: ${e.url}`),o.abort(),e.aborted=!0,t=!0),t})(a),senderType:y}};const w=D();var U=w;const k=Object(T.devFreeze)({chunked:!0,chunkSize:5242880,retries:0,parallel:1});let j=null;const N=(j=null,Object(T.hasWindow)()&&"Blob"in window&&(j=Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),!!j),F=(e,t,n)=>{var r;const o=null===(r=j)||void 0===r?void 0:r.call(e,t,n,e.type);return o&&(o.name=e.name,o.lastModified=e.lastModified),o};class B extends Error{constructor(e){super(e),this.name="ChunkedSendError"}}const x=Symbol.for("__rpldy-sstt-proxy__"),H=Symbol.for("__rpldy-sstt-state__"),M=e=>!Object(T.isProduction)()&&!!e&&!!~Object.getOwnPropertySymbols(e).indexOf(x),q=e=>Array.isArray(e)||Object(T.isPlainObject)(e)&&!(e=>Object(T.hasWindow)()&&e instanceof File||e.name&&e.size&&e.uri)(e),$=Object(T.getMerge)({withSymbols:!0,predicate:e=>e!==x&&e!==H}),z=e=>!!Object(T.isProduction)()||e[H].isUpdateable,G=(e,t)=>{Object(T.isProduction)()||(e[H].isUpdateable=t)},W=(e,t)=>{let n;return q(e)&&(M(e)||(e[x]=!0,n=new Proxy(e,t)),Object.keys(e).forEach(n=>{e[n]=W(e[n],t)})),n||e},V=e=>M(e)?Object(T.clone)(e,$):e;var K=e=>{const t={set:(e,r,o)=>(z(n)&&(e[r]=W(o,t)),!0),get:(e,t)=>t===x?V(e):e[t],defineProperty:()=>{throw new Error("Simple State doesnt support defining property")},setPrototypeOf:()=>{throw new Error("Simple State doesnt support setting prototype")},deleteProperty:(e,t)=>(z(n)&&delete e[t],!0)};Object(T.isProduction)()||M(e)||Object.defineProperty(e,H,{value:{isUpdateable:!1},configurable:!0});const n=Object(T.isProduction)()?e:W(e,t);return{state:n,update:e=>{if(!Object(T.isProduction)()&&z(n))throw new Error("Can't call update on State already being updated!");try{G(n,!0),e(n)}finally{G(n,!1)}return n},unwrap:e=>e?V(e):M(n)?V(n):n}};const X=Object(T.devFreeze)({CHUNK_START:"CHUNK_START",CHUNK_FINISH:"CHUNK_FINISH"}),Q="rpldy-chunked-sender";var Y=(e,t,n,r,o,a)=>(e.requests[n]={id:n,abort:r.abort},r.request.then(r=>{T.logger.debugLog(`chunkedSender: request finished for chunk: ${n} - `,r),delete e.requests[n];const s=e.chunks.findIndex(e=>e.id===n);if(~s){if(r.state===T.FILE_STATES.FINISHED){const n=e.chunks.splice(s,1)[0],u=n.end-n.start;a({loaded:u,total:t.file.size},[n]),o(X.CHUNK_FINISH,{chunk:Object(T.pick)(n,["id","start","end","index","attempt"]),item:V(t),uploadData:r})}else r.state!==T.FILE_STATES.ABORTED&&(e.chunks[s].attempt+=1);e.responses.push(r.response)}}));const J=(e,t,n)=>t&&`bytes ${e.start}-${e.start+t.size-1}/${n.file.size}`,Z=Object(T.getMerge)({undefinedOverwrites:!0}),ee=(e,t,n,r,o)=>{const a={...V(t.sendOptions),headers:{...t.sendOptions.headers,"Content-Range":J(e,e.data,n)}},s=Object(T.createBatchItem)(e.data,e.id),u=t=>{r(t,[e])},i=t.chunks.indexOf(e);return Object(T.triggerUpdater)(o,X.CHUNK_START,{item:V(n),chunk:Object(T.pick)(e,["id","start","end","index","attempt"]),chunkItem:s,sendOptions:a,url:t.url,chunkIndex:i,remainingCount:t.chunks.length,totalCount:t.chunkCount,onProgress:r}).then(e=>{const r=!1===e;return r&&T.logger.debugLog(`chunkedSender.sendChunk: received false from CHUNK_START handler - skipping chunk ${i}, item ${n.id}`),r?{request:Promise.resolve({state:T.FILE_STATES.FINISHED,response:"skipping chunk as instructed by CHUNK_START handler",status:200}),abort:()=>!0,senderType:"chunk-skipped-sender"}:U([s],(null==e?void 0:e.url)||t.url,Z({},a,e&&e.sendOptions),u)})};var te=(e,t,n,r,o)=>{if(e.data||(e.data=F(n.file,e.start,e.end)),!e.data)throw new B("chunk failure - failed to slice");T.logger.debugLog(`chunkedSender.sendChunk: about to send chunk ${e.id} [${e.start}-${e.end}] to: ${t.url||""}`);const a=ee(e,t,n,r,o);return{request:a.then(({request:e})=>e),abort:()=>(a.then(({abort:e})=>e()),!0),senderType:"chunk-passthrough-sender"}};const ne=(e,t)=>{e(t instanceof B?{state:T.FILE_STATES.ERROR,response:"At least one chunk failed"}:{state:T.FILE_STATES.ERROR,response:t.message})},re=(e,t,n,r)=>{e.finished=!0,n({state:r,response:{results:e.responses}})},oe=(e,t,n,r,o,a)=>new Promise((s,u)=>{try{const u=te(o,e,t,n,a);Y(e,t,o.id,u,a,n).then(()=>{s(),((e,t,n)=>{const r=!e.chunks.length;return e.aborted?(T.logger.debugLog("chunkedSender: chunked upload aborted for item: "+t.id),re(e,0,n,T.FILE_STATES.ABORTED)):r&&!e.error&&(T.logger.debugLog("chunkedSender: chunked upload finished for item: "+t.id,e.responses),re(e,0,n,T.FILE_STATES.FINISHED)),r||e.error})(e,t,r)||ae(e,t,n,r,a)})}catch(e){u(e)}}),ae=(e,t,n,r,o)=>{if(!e.finished&&!e.aborted){const a=Object.keys(e.requests).length;if(!a||e.parallel&&e.parallel>a){let a;try{a=(e=>{const t=[],n=Object.keys(e.requests),r=e.parallel||1;for(let o=0;o<e.chunks.length&&n.length<r&&t.length<r;o++){const r=e.chunks[o];if(!n.includes(r.id)){if(r.attempt&&!(r.attempt<e.retries))throw new B("chunk failure");t.push(r)}}return t})(e)}catch(e){ne(r,e)}a&&a.forEach(a=>{oe(e,t,n,r,a,o).catch(t=>{e.error=!0,ne(r,t)})})}}};var se=ae;var ue=(e,t,n,r)=>{e.uploaded[n]=Math.max(r,e.uploaded[n]||0);const o=Object.keys(e.uploaded).reduce((t,n)=>t+e.uploaded[n],e.startByte),a=t.file.size;return{loaded:Math.min(o,a),total:a}};const ie=(e,t,n,r)=>{const o=(r,o)=>{const a=ue(e,t,o[0].id,r.loaded);n(a,[t])};return{sendPromise:new Promise(n=>{se(e,t,o,n,r)}),abort:()=>((e,t)=>(T.logger.debugLog("chunkedSender: aborting chunked upload for item: "+t.id),e.finished||e.aborted||(Object.keys(e.requests).forEach(t=>{T.logger.debugLog("chunkedSender: aborting chunk: "+t),e.requests[t].abort()}),e.aborted=!0),e.aborted))(e,t)}};var de=(e,t,n,r,o,a)=>{const s=((e,t,n=0)=>{const{chunkSize:r}=t,o=n?e.file.size-n:e.file.size;if(o<=0)throw new B(`start byte ${n} is invalid. File size: ${e.file.size}`);const a=o<=r?1:Math.ceil(o/r);return new Array(a).fill(null).map((t,o)=>{const a=r*o+(n||0);return{id:`${e.id}_chunk-${o}`,start:a,end:Math.min(a+r,e.file.size),data:null,attempt:0,uploaded:0,index:o}})})(e,t,r.startByte);T.logger.debugLog(`chunkedSender: created ${s.length} chunks for: ${e.file.name}`);const u={finished:!1,aborted:!1,error:!1,uploaded:{},requests:{},responses:[],chunkCount:s.length,startByte:r.startByte||0,chunks:s,url:n,sendOptions:r,...t},{sendPromise:i,abort:d}=ie(u,e,o,a);return{request:i,abort:d,senderType:Q}};var ce=(e,t)=>{const n=(e=>Object(T.merge)({},k,e))(e);return{send:(e,r,o,a)=>{let s;return!n.chunked||e.length>1||e[0].url||!e[0].file.size?(s=U(e,r,o,a),T.logger.debugLog("chunkedSender: sending items as normal, un-chunked requests")):(T.logger.debugLog("chunkedSender: sending file as a chunked request"),s=de(e[0],n,r,o,a,t)),s}}},le=e=>(t,n)=>{const r=ce(e,n);return T.logger.debugLog("chunkedSenderEnhancer: Created chunked-sender instance with options: ",e),t.update({send:r.send}),t},fe=le,pe=n("JlUD"),ge=n.n(pe);var he=Object(T.devFreeze)({allowRegisterNonExistent:!0,canAddEvents:!0,canRemoveEvents:!0,collectStats:!1});const be=Symbol.for("__le__"),me=Symbol.for("__le__pack__"),Se=e=>e?e[be]:null,Ee=e=>{const t=Se(e);if(!t)throw new Error("Didnt find LE internal object. Something very bad happened!");return t},ve=e=>!!Se(e),Oe=(e,t,n,r=!1)=>{((e,t)=>{if(!Object(T.isFunction)(e))throw new Error(`'${t}' is not a valid function`)})(n,"cb");const o=Ee(e);if(!o.options.allowRegisterNonExistent&&!~o.events.indexOf(t))throw new Error(`Cannot register for event ${t.toString()} that wasn't already defined (allowRegisterNonExistent = false)`);const a=o.registry[t]||[];return a.find(e=>e.cb===n)||(a.push({name:t,cb:n,once:r}),o.registry[t]=a),()=>Re.call(e,t,n)},Te=(e,t)=>{const n=Ee(e).registry;return t?n[t]?n[t].slice():[]:Object.values(n).flat()},ye={on:function(e,t){return Oe(this,e,t)},once:function(e,t){return Oe(this,e,t,!0)},off:Re,getEvents:function(){return Ee(this).events.slice()}},Ie={trigger:function(e,...t){const n=Te(this,e);let r;if(n.length){var o;let a;1===t.length&&!0===(null===(o=t[0])||void 0===o?void 0:o[me])&&(a=t[0].resolve()),r=n.map(n=>{let r;return n.once&&_e(this,e,n.cb),r=a?n.cb(...a):t.length?1===t.length?n.cb(t[0]):2===t.length?n.cb(t[0],t[1]):3===t.length?n.cb(t[0],t[1],t[2]):n.cb(...t):n.cb(),r}).filter(e=>!(void 0===e)).map(e=>ge()(e)?e:Promise.resolve(e))}return r&&(r.length?r:void 0)},addEvent:function(e){const t=Ee(this);if(!t.options.canAddEvents)throw new Error("Cannot add new events (canAddEvents = false)");if(~t.events.indexOf(e))throw new Error(`Event '${e}' already defined`);t.events.push(e)},removeEvent:function(e){const t=Ee(this);if(!t.options.canRemoveEvents)throw new Error("Cannot remove events (canRemoveEvents = false)");{const n=t.events.indexOf(e);t.events.splice(n,1)}},hasEvent:function(e){return!!~Ee(this).events.indexOf(e)},hasEventRegistrations:function(e){return!!Te(this,e).length},assign:function(e){const t=Ee(this);return Ce(e,t.options,t.events,t.registry,t.stats),Ae(e)}},Ae=e=>Object.keys(Ie).reduce((t,n)=>(t[n]=Ie[n].bind(e),t),{target:e,...Ie}),Le=(e,t,n=!1)=>{const r=Ee(e).registry;!r[t]||!n&&r[t].length||delete r[t]},_e=(e,t,n)=>{const r=Ee(e).registry;r[t]&&(n?(r[t]=r[t].filter(e=>e.cb!==n),Le(e,t)):Le(e,t,!0))};function Re(e,t){_e(this,e,t)}const Ce=(e,t,n=[],r={},o={})=>{Object.defineProperties(e,{[be]:{value:Object.seal({registry:r,events:n,options:t,stats:o})},...Object.entries(ye).reduce((e,[t,n])=>(e[t]={value:n},e),{})})};var Pe=(e,t=[],n)=>(e=e||{},n={...he,...n},ve(e)||Ce(e,n,t),Ae(e));var De=e=>{const t={resolve:()=>[].concat(e())};return Object.defineProperty(t,me,{value:!0,configurable:!1}),t};const we="rpldy-mock-sender",Ue=Object(T.devFreeze)({delay:500,fileSize:1e6,progressIntervals:[10,25,50,75,99]}),ke=(e,t,n)=>e.then(e=>{var r;T.logger.debugLog("uploady.mockSender: mock request finished successfully");const o={sendOptions:n,mock:!0,success:!0},a={"x-request-type":"react-uploady.mockSender"},s=t.responseStatus||200;return{status:s,state:T.FILE_STATES.FINISHED,response:{...e,headers:a,data:t.response||(null===(r=n.formatServerResponse)||void 0===r?void 0:r.call(n,JSON.stringify(o),s,a))||o}}}).catch(e=>(T.logger.debugLog("uploady.mockSender: mock request was aborted",e),{status:0,state:T.FILE_STATES.ABORTED,response:"abort"}));var je=e=>{let t={...Ue,...e};return{send:(e,n,r,o)=>{T.logger.debugLog("uploady.mockSender: about to make a mock request for items: ",e);const a=((e,t)=>{const n=performance.now(),r=[];let o=!1,a=!1,s=null,u=null,i=null;const d=()=>{u&&(u.forEach(e=>{clearTimeout(e)}),u=null)},c=new Promise((t,o)=>{i=o,setTimeout(()=>{a=!0,t({options:e,time:performance.now()-n,progressEvents:r}),d()},e.delay||0)});return e.progressIntervals&&(u=e.progressIntervals.map(n=>{const u=n/100,i=(e.delay||0)*u;return setTimeout(()=>{if(!o&&!a&&s){const n={total:e.fileSize||0,loaded:(e.fileSize||0)*u};r.push(n),s(n,t)}},i)})),{then:c.then.bind(c),abort:()=>(o=!0,a=!0,i&&i(),d(),!0),onProgress:e=>{s=e}}})(t,e);return a.onProgress(o),{request:ke(a,t,r),abort:a.abort,senderType:we}},update:e=>{t={...t,...e}}}},Ne=e=>t=>{const n=je(e);return t.update({send:n.send}),t},Fe=je;const Be=Object(T.devFreeze)({BATCH_ADD:"BATCH-ADD",BATCH_START:"BATCH-START",BATCH_PROGRESS:"BATCH_PROGRESS",BATCH_FINISH:"BATCH-FINISH",BATCH_ABORT:"BATCH-ABORT",BATCH_CANCEL:"BATCH-CANCEL",ITEM_START:"FILE-START",ITEM_CANCEL:"FILE-CANCEL",ITEM_PROGRESS:"FILE-PROGRESS",ITEM_FINISH:"FILE-FINISH",ITEM_ABORT:"FILE-ABORT",ITEM_ERROR:"FILE-ERROR",ITEM_FINALIZE:"FILE-FINALIZE",REQUEST_PRE_SEND:"REQUEST_PRE_SEND",ALL_ABORT:"ALL_ABORT"}),xe=Object(T.devFreeze)({ITEM_PROGRESS:"ITEM_PROGRESS",BATCH_PROGRESS:"BATCH_PROGRESS"}),He=[T.FILE_STATES.FINISHED,T.FILE_STATES.ERROR,T.FILE_STATES.CANCELLED,T.FILE_STATES.ABORTED],Me=[T.BATCH_STATES.ADDED,T.BATCH_STATES.PROCESSING,T.BATCH_STATES.UPLOADING],qe=[T.BATCH_STATES.ABORTED,T.BATCH_STATES.CANCELLED,T.BATCH_STATES.FINISHED],$e=(e,t)=>e.batches[t].batch,ze=(e,t,n)=>e.getState().items[t].batchId===n,Ge=(e,t)=>{const n=e.getState(),r=n.items[t];return n.batches[r.batchId]},We=(e,t)=>Ge(e,t).batch,Ve=(e,t)=>{const n=((e,t)=>$e(e.getState(),t))(e,t);e.updateState(e=>{n.items.forEach(({id:t})=>{delete e.items[t];const n=e.itemQueue.indexOf(t);~n&&e.itemQueue.splice(n,1)})})},Ke=(e,t)=>{e.updateState(e=>{delete e.batches[t]})},Xe=(e,t,n)=>{const r=e.getState(),o=$e(r,t),a=r.items,s={...V(o),items:o.items.map(({id:e})=>V(a[e]))};e.trigger(n,s)},Qe=(e,t)=>{const n=We(e,t);return Me.includes(n.state)},Ye=e=>qe.includes(e.state),Je={[T.FILE_STATES.PENDING]:null,[T.FILE_STATES.ADDED]:Be.ITEM_START,[T.FILE_STATES.FINISHED]:Be.ITEM_FINISH,[T.FILE_STATES.ERROR]:Be.ITEM_ERROR,[T.FILE_STATES.CANCELLED]:Be.ITEM_CANCEL,[T.FILE_STATES.ABORTED]:Be.ITEM_ABORT,[T.FILE_STATES.UPLOADING]:Be.ITEM_PROGRESS},Ze=e=>!!~He.indexOf(e.state);var et=(e,t,n)=>(t.forEach(t=>{const n=e.getState(),{id:r,info:o}=t;if(T.logger.debugLog("uploader.processor.queue: request finished for item - ",{id:r,info:o}),n.items[r]){e.updateState(e=>{const t=e.items[r];t.state=o.state,t.uploadResponse=o.response,t.uploadStatus=o.status,Ze(t)&&delete e.aborts[r]});const t=e.getState().items[r];o.state===T.FILE_STATES.FINISHED&&t.completed<100&&e.handleItemProgress(t,100,t.file?t.file.size:0),Je[t.state]&&e.trigger(Je[t.state],t),Ze(t)&&(((e,t)=>{e.updateState(e=>{e.batches[t].finishedCounter+=1})})(e,t.batchId),e.trigger(Be.ITEM_FINALIZE,t))}const a=n.itemQueue.indexOf(r);~a&&e.updateState(e=>{e.itemQueue.splice(a,1);const t=e.activeIds.indexOf(r);~t&&e.activeIds.splice(t,1)})}),(e=>{const t=e.getState();Object.keys(t.batches).forEach(n=>{const{batch:r,finishedCounter:o}=t.batches[n],{orgItemCount:a}=r,s=Ye(r);a===o&&(s||100===r.completed||(e.updateState(e=>{const t=$e(e,n);t.completed=100,t.loaded=t.items.reduce((e,{loaded:t})=>e+t,0)}),Xe(e,n,Be.BATCH_PROGRESS)),e.updateState(e=>{const t=$e(e,n);t.state=s?t.state:T.BATCH_STATES.FINISHED,e.currentBatch===n&&(e.currentBatch=null)}),T.logger.debugLog("uploady.uploader.batchHelpers: cleaning up batch: "+r.id),s||Xe(e,n,Be.BATCH_FINISH),Ve(e,n),Ke(e,n))})})(e),n(e));const tt=Object(T.getMerge)({undefinedOverwrites:!0}),nt=(e,t)=>{const n=t.map(e=>e.id);return e.updateState(e=>{e.activeIds=e.activeIds.concat(n)}),((e,t,n)=>Object(T.triggerUpdater)(e.trigger,Be.REQUEST_PRE_SEND,{items:t,options:n}).then(e=>{if(e){if(T.logger.debugLog("uploader.queue: REQUEST_PRE_SEND event returned updated items/options",e),e.items){if(e.items.length!==t.length||!Object(T.isSamePropInArrays)(e.items,t,["id","batchId","recycled"]))throw new Error("REQUEST_PRE_SEND event handlers must return same items with same ids");t=e.items}e.options&&(n=tt({},n,e.options))}return{items:t,options:n,cancelled:!1===e}}))(e,t,e.getState().batches[t[0].batchId].batchOptions).then(n=>{if(!n.cancelled){e.updateState(e=>{n.items.forEach(t=>{e.items[t.id]=t}),e.batches[t[0].batchId].batchOptions=n.options});const r=e.getState();n.items=n.items.map(e=>r.items[e.id]),n.options=r.batches[t[0].batchId].batchOptions}return n})},rt=(e,t,n)=>{const{items:r,options:o}=t,a=e.getState().batches[r[0].batchId].batch;let s;try{s=e.sender.send(r,a,o)}catch(e){T.logger.debugLog("uploader.queue: sender failed with unexpected error",e),s={request:Promise.resolve({status:0,state:T.FILE_STATES.ERROR,response:e.message}),abort:()=>!1,senderType:"exception-handler"}}const{request:u}=s;return((e,t,n)=>{e.updateState(e=>{t.forEach(t=>{e.items[t.id].state=T.FILE_STATES.UPLOADING,e.aborts[t.id]=n.abort})})})(e,r,s),u.then(t=>{const o=r.map(e=>({id:e.id,info:t}));et(e,o,n)})};var ot=(e,t,n)=>{const r=e.getState();let o=Object.values(r.items);return o=o.filter(e=>!!~t.indexOf(e.id)),Promise.all(o.map(t=>e.runCancellable(Be.ITEM_START,t))).then(t=>({allowedItems:t.map((t,n)=>t?null:((e,t)=>t.getState().items[e])(o[n].id,e)).filter(Boolean),cancelledResults:t})).then(({allowedItems:r,cancelledResults:a})=>(r.length?nt(e,r).then():Promise.resolve()).then(r=>{let s;return r&&(r.cancelled?a=t.map(()=>!0):rt(e,r,n)),((e,t,n,r)=>{const o=n.map((e,n)=>e?t[n].id:null).filter(Boolean);if(o.length){const t=o.map(e=>({id:e,info:{status:0,state:T.FILE_STATES.CANCELLED,response:"cancel"}}));et(e,t,r)}return!!o.length})(e,o,a,n)||(s=n(e)),s}))};const at=(e,t)=>!!~e.getState().activeIds.flat().indexOf(t),st=e=>{const t=e.getState().itemQueue,n=(e=>{const t=e.getState(),n=t.itemQueue,r=t.items;let o=0,a=n[o];for(;a&&(at(e,a)||!Qe(e,a)||r[a].state!==T.FILE_STATES.ADDED);)o+=1,a=n[o];return a?o:-1})(e);let r,o=t[n];if(o){const a=Ge(e,o),s=a.batch.id,u=a.batchOptions.maxGroupSize||0;if(a.batchOptions.grouped&&u>1){r=[];let a=!0;for(;r.length<u&&a;)r.push(o),o=t[n+r.length],a=o&&ze(e,o,s)}else r=[o]}return r},ut=e=>{const t=st(e);let n=Promise.resolve();if(t){const r=e.getCurrentActiveCount(),{concurrent:o=0,maxConcurrent:a=0}=e.getOptions();if(!r||o&&r<a){T.logger.debugLog("uploader.processor: Processing next upload - ",{ids:t,state:e.getState(),currentCount:r});let o=!1,a=Promise.resolve(!1);((e,t)=>{const n=We(e,t);return e.getState().currentBatch!==n.id})(e,t[0])&&(a=((e,t)=>{const n=We(e,t);return e.runCancellable(Be.BATCH_START,n).then(t=>(t||e.updateState(e=>{e.currentBatch=n.id}),!t))})(e,t[0]).then(n=>(o=!n,o&&(((e,t)=>{const n=We(e,t),r=n.id;T.logger.debugLog("uploady.uploader.batchHelpers: cancelling batch: ",{batch:n}),e.updateState(e=>{$e(e,r).state=T.BATCH_STATES.CANCELLED}),Xe(e,r,Be.BATCH_CANCEL),Ve(e,r),Ke(e,r)})(e,t[0]),ut(e)),o))),n=a.then(n=>{n||ot(e,t,ut)})}}return n};var it=ut;const dt=(e,t,n)=>(T.logger.debugLog(`uploader.queue: aborting ${t.state} item  - `,t),et(e,[{id:t.id,info:{status:0,state:T.FILE_STATES.ABORTED,response:"aborted"}}],n),!0),ct={[T.FILE_STATES.UPLOADING]:(e,t)=>(T.logger.debugLog("uploader.queue: aborting uploading item  - ",t),e.getState().aborts[t.id]()),[T.FILE_STATES.ADDED]:dt,[T.FILE_STATES.PENDING]:dt},lt=(e,t,n)=>{const r=e.getState().items[t],o=null==r?void 0:r.state;return!!ct[o]&&ct[o](e,r,n)};var ft=(e,t,n,r,o)=>{const{state:a,update:s}=K({itemQueue:[],currentBatch:null,batches:{},items:{},activeIds:[],aborts:{}}),u=()=>a,i=e=>{s(e)},d=e=>{if(a.items[e.id]&&!e.recycled)throw new Error(`Uploader queue conflict - item ${e.id} already exists`);e.recycled&&((e,t)=>{const{previousBatch:n}=t;if(t.recycled&&n&&e.getState().batches[n]){const{id:r}=We(e,t.id);r===n&&e.updateState(e=>{const n=$e(e,r),o=n.items.findIndex(({id:e})=>e===t.id);~o&&n.items.splice(o,1)})}})(l,e),i(t=>{t.items[e.id]=e,t.itemQueue.push(e.id)})},c=(e,n,r)=>{a.items[e.id]&&(i(t=>{const o=t.items[e.id];o.loaded=r,o.completed=n}),t(Be.ITEM_PROGRESS,u().items[e.id]))};r.on(xe.ITEM_PROGRESS,c),r.on(xe.BATCH_PROGRESS,e=>{var n;const r=null===(n=a.batches[e.id])||void 0===n?void 0:n.batch.items;if(r){const[n,o]=r.reduce((e,{completed:t,loaded:n})=>(e[0]+=t,e[1]+=n,e),[0,0]);i(t=>{const a=t.batches[e.id].batch;a.completed=n/r.length,a.loaded=o}),t(Be.BATCH_PROGRESS,a.batches[e.id].batch)}});const l={uploaderId:o,getOptions:()=>e,getCurrentActiveCount:()=>a.activeIds.length,getState:u,updateState:i,trigger:t,runCancellable:(e,...t)=>{if(!Object(T.isFunction)(n))throw new Error("cancellable is of wrong type");return n(e,...t)},sender:r,handleItemProgress:c};return Object(T.hasWindow)()&&T.logger.isDebugOn()&&(window[`__rpldy_${o}_queue_state`]=l),{updateState:i,getState:l.getState,runCancellable:l.runCancellable,uploadBatch:(e,t)=>{t&&i(n=>{n.batches[e.id].batchOptions=t}),it(l)},addBatch:(e,t)=>(i(n=>{n.batches[e.id]={batch:e,batchOptions:t,finishedCounter:0}}),e.items.forEach(d),$e(a,e.id)),abortItem:e=>((e,t,n)=>lt(e,t,n))(l,e,it),abortBatch:e=>{((e,t,n)=>{const r=e.getState().batches[t],o=null==r?void 0:r.batch;o&&!Ye(o)&&(e.updateState(e=>{$e(e,t).state=T.BATCH_STATES.ABORTED}),Xe(e,t,Be.BATCH_ABORT),o.items.forEach(t=>lt(e,t.id,n)))})(l,e,it)},abortAll:()=>{((e,t)=>{const n=e.getState().items;Object.keys(n).forEach(n=>lt(e,n,t)),e.trigger(Be.ALL_ABORT)})(l,it)},clearPendingBatches:()=>{(e=>{const t=e.getState().batches;Object.keys(t).filter(e=>t[e].batch.state===T.BATCH_STATES.PENDING).forEach(t=>{Ve(e,t),Ke(e,t)})})(l)},uploadPendingBatches:e=>{((e,t)=>{e.updateState(e=>{Object.keys(e.batches).forEach(n=>{const r=e.batches[n],{batch:o,batchOptions:a}=r;o.state===T.BATCH_STATES.PENDING&&(o.items.forEach(e=>{e.state=T.FILE_STATES.ADDED}),o.state=T.BATCH_STATES.ADDED,r.batchOptions=Object(T.merge)({},a,t))})})})(l,e),it(l)}}};const pt=()=>!0,gt=Object(T.devFreeze)({autoUpload:!0,clearPendingOnAdd:!1,inputFieldName:"file",concurrent:!1,maxConcurrent:2,grouped:!1,maxGroupSize:5,method:"POST",params:{},fileFilter:pt,forceJsonResponse:!1,withCredentials:!1,destination:{},send:null,sendWithFormData:!0}),ht=(e,t,n,r)=>{((e,t,n,r)=>{e.forEach(e=>{T.logger.debugLog(`uploady.uploader.processor: file: ${e.id} progress event: loaded(${n}) - completed(${t})`),r(xe.ITEM_PROGRESS,e,t,n)})})(e,Math.min(n.loaded/n.total*100,100)/e.length,n.loaded/e.length,r),r(xe.BATCH_PROGRESS,t)};var bt=()=>{const{trigger:e,target:t}=Pe({send:(t,n,r)=>{const o=r.destination,a=null==o?void 0:o.url,s=Object(T.throttle)(r=>ht(t,n,r,e),50,!0);return(Object(T.isFunction)(r.send)?r.send:U)(t,a,{method:(null==o?void 0:o.method)||r.method||gt.method,paramName:(null==o?void 0:o.filesParamName)||r.inputFieldName||"file",params:{...r.params,...null==o?void 0:o.params},forceJsonResponse:r.forceJsonResponse,withCredentials:r.withCredentials,formatGroupParamName:r.formatGroupParamName,headers:null==o?void 0:o.headers,sendWithFormData:r.sendWithFormData,formatServerResponse:r.formatServerResponse},s)}},Object.values(xe));return t};const mt=Object(T.hasWindow)()&&"FileList"in window,St=(e,t=0)=>{let n=e;return Object(T.isProduction)()||(t<3&&M(e)?n=V(e):t<3&&q(e)&&(n=Array.isArray(e)?e.map(e=>St(e,t+1)):Object.keys(e).reduce((n,r)=>(n[r]=St(e[r],t+1),n),{}))),n};let Et=0;var vt=(e,t,n)=>{Et+=1;const r="batch-"+Et,o=(e=>mt&&e instanceof FileList||"[object FileList]"===e.toString())(e);e=Array.isArray(e)||o?e:[e];const a=!n.autoUpload,s=((e,t,n,r)=>Array.prototype.filter.call(t,r||pt).map(t=>Object(T.createBatchItem)(t,e,n)))(r,e,a,n.fileFilter);return{id:r,uploaderId:t,items:s,state:a?T.BATCH_STATES.PENDING:T.BATCH_STATES.ADDED,completed:0,loaded:0,orgItemCount:s.length}};const Ot=Object.values(Be);let Tt=0;var yt=e=>{Tt+=1;const t="uploader-"+Tt;let n=!1;const r={};T.logger.debugLog(`uploady.uploader: creating new instance (${t})`,{options:e,counter:Tt});let o=(e=>{return{...gt,...e,destination:e&&e.destination?(t=e.destination,{params:{},...t}):null};var t})(e);const a=()=>{c.clearPendingBatches()};let{trigger:s,target:u}=Pe({id:t,update:e=>(o=Object(T.merge)({},o,e),u),add:(e,t)=>{const n=Object(T.merge)({},o,t);n.clearPendingOnAdd&&a();const r=c.addNewBatch(e,u.id,n);let s;return r.items.length?s=c.runCancellable(Be.BATCH_ADD,r,n).then(e=>{e?(r.state=T.BATCH_STATES.CANCELLED,i(Be.BATCH_CANCEL,r)):(T.logger.debugLog(`uploady.uploader [${u.id}]: new items added - auto upload =\n                        ${String(n.autoUpload)}`,r.items),n.autoUpload&&c.process(r))}):T.logger.debugLog(`uploady.uploader: no items to add. batch ${r.id} is empty. check fileFilter if this isn't intended`),s||Promise.resolve()},upload:e=>{c.processPendingBatches(e)},abort:e=>{c.abort(e)},abortBatch:e=>{c.abortBatch(e)},getOptions:()=>Object(T.clone)(o),clearPending:a,registerExtension:(e,t)=>{Object(T.invariant)(n,"Uploady - uploader extensions can only be registered by enhancers"),Object(T.invariant)(!r[e],"Uploady - uploader extension by this name [%s] already exists",e),T.logger.debugLog("uploady.uploader: registering extension: "+e.toString(),t),r[e]=t},getExtension:e=>r[e]},Ot,{canAddEvents:!1,canRemoveEvents:!1});const i=(e,...t)=>{const n=De(()=>t.map(St));return s(e,n)},d=Object(T.triggerCancellable)(i);if(o.enhancer){n=!0;const e=o.enhancer(u,i);n=!1,u=e||u}const c=((e,t,n,r)=>{const o=bt(),a=ft(n,e,t,o,r);return{process:(e,t)=>{a.uploadBatch(e,t)},abortBatch:e=>{a.abortBatch(e)},abort:e=>{e?a.abortItem(e):a.abortAll()},addNewBatch:(e,t,n)=>{const r=vt(e,t,n);return a.addBatch(r,n)},runCancellable:a.runCancellable,clearPendingBatches:()=>{a.clearPendingBatches()},processPendingBatches:e=>{a.uploadPendingBatches(e)}}})(i,d,o,u.id);return Object(T.devFreeze)(u)},It=(...e)=>(t,...n)=>e.reduce((e,t)=>t(e,...n)||e,t),At=yt;const Lt=Symbol.for("__upldy-retry__"),_t="RETRY_EVENT",Rt=[T.FILE_STATES.ABORTED,T.FILE_STATES.ERROR],Ct=(e,t,n,r,o)=>{const a=t.getState().failed,s=(r=r||Object.keys(a)).map(e=>a[e]).filter(Boolean);var u;s.length&&(o={...o||null,autoUpload:void 0===(null===(u=o)||void 0===u?void 0:u.autoUpload)||o.autoUpload},n(_t,{items:s,options:o}),r.forEach(e=>((e,t)=>{e.updateState(e=>{const n=e.failed[t].batchId;delete e.failed[t];const r=e.batchIdsMap[n].indexOf(t);e.batchIdsMap[n].splice(r,1),e.batchIdsMap[n].length||delete e.batchIdsMap[n]})})(t,e)),e.add(s,o));return!!s.length},Pt=(e,t,n,r,o)=>{let a;return r?a=((e,t,n,r,o)=>(T.logger.debugLog("uploady.retry: about to retry item: "+r),Ct(e,t,n,[r],o)))(e,t,n,r,o):(T.logger.debugLog("uploady.retry: about to retry all failed item"),a=Ct(e,t,n,null,o)),a};var Dt=(e,t)=>{const n=(()=>{const{state:e,update:t}=K({batchIdsMap:{},failed:{}});return{updateState:e=>{t(e)},getState:()=>e}})();return((e,t)=>{e.on(Be.ITEM_FINALIZE,e=>{~Rt.indexOf(e.state)&&t.updateState(t=>{t.failed[e.id]=e;(t.batchIdsMap[e.batchId]=t.batchIdsMap[e.batchId]||[]).push(e.id)})})})(e,n),e.registerExtension(Lt,{retry:(r,o)=>Pt(e,n,t,r,o),retryBatch:(r,o)=>((e,t,n,r,o)=>{var a;T.logger.debugLog("uploady.retry: about to retry batch: "+r);const s=null===(a=t.getState().batchIdsMap[r])||void 0===a?void 0:a.slice();return!!s&&Ct(e,t,n,s,o)})(e,n,t,r,o)}),e},wt=e=>{let t=!1;(()=>{try{if(Object(T.hasWindow)()&&e in window){const n="__lsTest";window[e].setItem(n,"__test-"+Date.now()),window[e].removeItem(n),t=!0}}catch(e){}})();const n=["key","getItem","setItem","removeItem","clear"].reduce((n,r)=>(n[r]=(...n)=>t?window[e][r](...n):void 0,n),{});return n.isSupported=t,Object.defineProperty(n,"length",{get:()=>t?window[e].length:0}),n},Ut=wt("localStorage"),kt=wt("sessionStorage");const jt=Object(T.devFreeze)({...k,featureDetection:!1,featureDetectionUrl:null,version:"1.0.0",resume:!0,overrideMethod:!1,deferLength:!1,sendDataOnCreate:!1,storagePrefix:"__rpldy-tus__",lockedRetryDelay:2e3,forgetOnSuccess:!1,ignoreModifiedDateInStorage:!1}),Nt=(e,t,n)=>{const r=[e.file.name,e.file.type,e.file.size,t.ignoreModifiedDateInStorage?null:e.file.lastModified,n].filter(Boolean).join("/");return`${t.storagePrefix||jt.storagePrefix}${r}`},Ft=(e,t,n,r)=>{n.resume&&Ut.setItem(Nt(e,n,r),JSON.stringify({time:Date.now(),uploadUrl:t}))},Bt=(e,t,n)=>{const r=Nt(e,t,n);Ut.removeItem(r)},xt=e=>{const t=e.storagePrefix||jt.storagePrefix;for(let e=0;e<Ut.length;e++){const n=Ut.key(e);n&&!n.indexOf(t)&&Ut.removeItem(n)}};var Ht=n("R8cT"),Mt=n.n(Ht);const qt=Symbol.for("__upldy-tus__"),$t="rpldy-tus-sender",zt=[200,201,204],Gt="creation-with-upload",Wt="concatenation",Vt="creation-defer-length",Kt=e=>{const t=e.params&&Object.keys(e.params);return null!=t&&t.length?t.map(t=>`${t} ${btoa(e.params[t])}`).join(","):void 0},Xt=(e,t)=>e.then(e=>(e.state===T.FILE_STATES.FINISHED&&(e.response.location=t),e)),Qt=(e,t,n,r,o)=>{const{options:a}=n.getState(),s=((e,t)=>{let n;return n=/^(http:|https:)?\/\//.test(t)?t:t.startsWith("/")?(e.startsWith("/")?"":new Mt.a(e).origin.replace(/\/$/,""))+t:[e.replace(/\/$/,""),t.replace(/^\//,"")].join("/"),n})(t,r.getResponseHeader("Location"));let u=0,i=!1;if(T.logger.debugLog(`tusSender.create: successfully created upload for item: ${e.id} - upload url = ${s}`),a.sendDataOnCreate){const e=parseInt(r.getResponseHeader("Upload-Offset"));u=isNaN(e)?u:e,i=+a.parallel>1&&u===(null==o?void 0:o.size)}return n.updateState(t=>{t.items[e.id].uploadUrl=s,t.items[e.id].offset=u}),{offset:u,uploadUrl:s,isNew:!0,isDone:i}};var Yt=(e,t,n,r,o)=>{const{options:a}=n.getState(),s={"tus-resumable":a.version,"Upload-Defer-Length":a.deferLength?1:void 0,"Upload-Length":a.deferLength?void 0:e.file.size,"Upload-Metadata":o?void 0:Kt(r),"Content-Type":a.sendDataOnCreate?"application/offset+octet-stream":void 0,...r.headers};let u=null;if(T.logger.debugLog(`tusSender.create - creating upload for ${e.id} at: ${t}`),a.sendDataOnCreate){T.logger.debugLog("tusSender.create - adding first chunk to create request");const t=+a.chunkSize;u=t<e.file.size?F(e.file,0,t):e.file}const i=Object(T.request)(t,u,{method:"POST",headers:s});let d=!1;return{request:i.then(r=>{let o=null;return r&&~zt.indexOf(r.status)?o=Qt(e,t,n,r,u):T.logger.debugLog("tusSender.create: create upload failed for item: "+e.id,r),o}).catch(e=>(T.logger.debugLog("tusSender.create: create upload failed",e),null)).finally(()=>{d=!0}),abort:()=>(d||(T.logger.debugLog("tusSender.create: aborting create request for item: "+e.id),i.xhr.abort()),!d)}};const Jt=(e,t,n)=>(Bt(e,t,n),{isNew:!1,canResume:!1}),Zt=(e,t,n,r,o)=>{const{options:a}=n.getState();T.logger.debugLog(`tusSender.resume - resuming upload for ${e.id}${r?"-"+r:""} at: ${t}`);const s=Object(T.request)(t,null,{method:"HEAD",headers:{"tus-resumable":a.version}});let u=!1;return{request:s.then(s=>{let u;return s&&~zt.indexOf(s.status)?u=((e,t,n,r)=>{let o=!1,a=!1;T.logger.debugLog(`tusSender.resume - successfully initiated resume for item: ${e.id} - upload url = ${t}`);const s=parseInt(r.getResponseHeader("Upload-Offset"));if(!isNaN(s)){const u=parseInt(r.getResponseHeader("Upload-Length"));isNaN(u)&&!n.getState().options.deferLength||(a=s===u,o=!a,n.updateState(n=>{n.items[e.id].uploadUrl=t,n.items[e.id].offset=s}))}return{offset:s,uploadUrl:t,isNew:!1,isDone:a,canResume:o}})(e,t,n,s):423===(null==s?void 0:s.status)&&0===o?(T.logger.debugLog(`tusSender.resume: upload is locked for item: ${e.id}. Will retry in ${+a.lockedRetryDelay}`,s),u=((e,t,n,r,o)=>new Promise(a=>{setTimeout(()=>{Zt(e,t,n,r,o).request.then(a)},n.getState().options.lockedRetryDelay)}))(e,t,n,r,1)):(T.logger.debugLog(`tusSender.resume: failed for item: ${e.id}${r?"-"+r:""}`,s),u=Jt(e,a,r)),u}).catch(t=>(T.logger.debugLog("tusSender.resume: resume upload failed unexpectedly",t),Jt(e,a,r))).finally(()=>{u=!0}),abort:()=>(u||(T.logger.debugLog("tusSender.resume: aborting resume request for item: "+e.id),s.xhr.abort()),!u)}};var en=(e,t,n,r,o)=>o.then(o=>{let a=o;if(o.state===T.FILE_STATES.FINISHED){const{options:s,items:u}=n.getState(),i=u[e.id];if(i){const d=i.parallelChunks,c=d.filter(e=>{var t;return null===(t=u[e])||void 0===t?void 0:t.uploadUrl}).map(e=>u[e].uploadUrl);if(c.length!==d.length)throw new Error(`tusSender: something went wrong. found ${c.length} upload urls for ${d.length} chunks`);const l={"tus-resumable":s.version,"Upload-Concat":"final;"+c.join(" "),"Upload-Metadata":Kt(r)};T.logger.debugLog("tusSender.finalizeParallel: sending finalizing request",{url:t,headers:l});const f=Object(T.request)(t,null,{method:"POST",headers:l});n.updateState(t=>{t.items[e.id].abort=()=>(f.xhr.abort(),!0)}),a=((e,t)=>e.catch(e=>(T.logger.debugLog("tusSender.finalizeParallel: finalize request failed unexpectedly!",e),e)).then(e=>{let n;const r=(null==e?void 0:e.status)||0,o=!!~zt.indexOf(r),a=o&&e&&"getResponseHeader"in e&&e.getResponseHeader("Location");return a?(T.logger.debugLog("tusSender.finalizeParallel: successfully finalized parallel upload",a),n=Xt(Promise.resolve(t),a)):(T.logger.debugLog("tusSender.finalizeParallel: parallel upload finalize failed!",r),n={status:r,state:T.FILE_STATES.ERROR,response:{message:(null==e?void 0:e.response)||(o&&!a?"No valid location header for finalize request":"")}}),n}))(f,o)}}return a});const tn=(e,t,n,r,o,a,s,u,i)=>s.then(s=>{let d,c=!1;if(s?s.isDone?(T.logger.debugLog("tusSender.handler: resume found server has completed file for item: "+e[0].id,e[0]),d=Xt(Promise.resolve({status:200,state:T.FILE_STATES.FINISHED,response:{message:"TUS server has file"}}),s.uploadUrl)):s.isNew||s.canResume?d=i?((e,t,n,r)=>{const o=e[0];return n.uploadUrl&&Ft(o,n.uploadUrl,t.getState().options,r),T.logger.debugLog("tusSender.handler: created upload for parallelized chunk: "+o.id),Promise.resolve({status:200,state:T.FILE_STATES.UPLOADING,response:"TUS server created upload for parallelized part"})})(e,o,s,i):((e,t,n,r,o,a,s)=>{const{options:u}=o.getState(),i=e[0];T.logger.debugLog(`tusSender.handler: init request finished. sending item ${i.id} as chunked`,s),s.isNew&&s.uploadUrl&&Ft(i,s.uploadUrl,u),(s.canResume||u.sendDataOnCreate&&s.offset)&&(n={...n,startByte:s.offset});const d=a.send(e,t,n,r);return o.updateState(e=>{e.items[i.id].abort=d.abort}),+u.parallel>1?en(i,t,o,n,d.request):Xt(d.request,s.uploadUrl)})(e,t,n,r,o,a,s):c=!0:c=u,c){T.logger.debugLog("tusSender.handler: resume init failed. Will try creating a new upload for item: "+e[0].id);const{request:s}=Yt(e[0],t,o,n);d=tn(e,t,n,r,o,a,s)}return d||Promise.resolve({status:0,state:T.FILE_STATES.ERROR,response:"TUS initialize failed"})});var nn=tn;var rn=(e,t,n,r,o,a,s=null)=>{const{options:u}=o.getState(),i=+u.parallel>1&&!s,d=e[0],c=!i&&((e,t,n)=>{let r;const o=Nt(e,t,n);if(t.resume)try{const e=Ut.getItem(o);if(e){r=JSON.parse(e).uploadUrl}}catch(e){T.logger.debugLog("tusSender.resumableStore: failed to retrieve persisted data for key: "+o,e)}return r})(d,u,s);let l;((e,t)=>{t.updateState(t=>{t.items[e.id]={id:e.id,uploadUrl:null,size:e.file.size,offset:0,parallelChunks:[]}})})(d,o),l=i?{request:Promise.resolve({isNew:!0}),abort:()=>!0}:c?((e,t,n,r)=>Zt(e,t,n,r,0))(d,c,o,s):Yt(d,t,o,n,s);return{request:nn(e,t,n,r,o,a,l.request,!!c,s),abort:()=>(T.logger.debugLog("tusSender.handler: abort called for item: "+d.id),l.abort(),l.request.then(e=>{if(e){T.logger.debugLog("tusSender.handler: aborting chunked upload for item:  "+d.id);const e=o.getState().items[d.id].abort;e&&e()}}),!0)}};const on=(e,t)=>`_prlChunk_${+e.chunkSize}_${t}`;var an=(e,t,n)=>{N&&(e.on(Be.ITEM_FINALIZE,e=>{const{items:n,options:r}=t.getState(),o=n[e.id];if(o){T.logger.debugLog(`tusSender.handleEvents: item ${e.id} finalized (${e.state}). Removing from state`);const n=o.parallelChunks;t.updateState(t=>{n.length&&n.forEach(e=>{delete t.items[e]}),delete t.items[e.id]}),r.forgetOnSuccess&&(T.logger.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing item url from storage: "+e.id),Bt(e,r))}}),e.on(X.CHUNK_START,e=>{const{options:r}=t.getState(),o=+r.parallel>1;return(o?((e,t,n)=>{const{item:r,chunkItem:o,url:a,sendOptions:s,onProgress:u,chunk:i}=n,{options:d}=e.getState();e.updateState(e=>{e.items[r.id].parallelChunks.push(o.id)});return rn([o],a,{...s,params:null},u,e,t,on(d,i.index)).request.then(e=>e.state!==T.FILE_STATES.FINISHED)})(t,n,e):Promise.resolve(!0)).then(n=>n&&((e,t,n)=>{const{item:r,chunk:o,chunkItem:a,remainingCount:s}=t,{options:u}=e.getState(),i=e.getState().items[n?a.id:r.id],d=n?0:i.offset||o.start,c={"tus-resumable":u.version,"Upload-Offset":d,"Content-Type":"application/offset+octet-stream","Content-Range":void 0,"X-HTTP-Method-Override":u.overrideMethod?"PATCH":void 0,"Upload-Length":u.deferLength&&!s?r.file.size:void 0,"Upload-Concat":n?"partial":void 0};return T.logger.debugLog("tusSender.handleEvents: chunk start handler. offset = "+d,{headers:c,url:i.uploadUrl}),{sendOptions:{sendWithFormData:!1,method:u.overrideMethod?"POST":"PATCH",headers:c},url:i.uploadUrl}})(t,e,o))}),e.on(X.CHUNK_FINISH,({item:e,chunk:n,uploadData:r})=>{const{items:o,options:a}=t.getState();if(+a.parallel>1){if(a.forgetOnSuccess){const t=on(a,n.index);T.logger.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing parallel chunk url from storage: "+t),Bt(e,a,t)}}else if(o[e.id]){const{status:o,response:a}=r;T.logger.debugLog(`tusSender.handleEvents: received upload response (code: ${o}) for : ${e.id}, chunk: ${n.id}`,a),~zt.indexOf(o)&&a.headers&&t.updateState(t=>{t.items[e.id].offset=a.headers["upload-offset"]})}}))};const sn=e=>"rpldy_tus_fd_"+e,un={[Wt]:(e,t)=>{+t.getState().options.parallel>1&&!~e.indexOf(Wt)&&(T.logger.debugLog(`tusSender.featureDetection: disabling parallel uploads, ${Wt} extension not available`),t.updateState(e=>{e.options.parallel=1}))},[Gt]:(e,t)=>{t.getState().options.sendDataOnCreate&&!~e.indexOf(Gt)&&(T.logger.debugLog(`tusSender.featureDetection: disabling create with data, ${Gt} extension not available`),t.updateState(e=>{e.options.sendDataOnCreate=!1}))},[Vt]:(e,t)=>{t.getState().options.deferLength&&!~e.indexOf(Vt)&&(T.logger.debugLog(`tusSender.featureDetection: disabling defer length, ${Vt} extension not available`),t.updateState(e=>{e.options.deferLength=!1}))}},dn=(e,t,n)=>{const{options:r}=e.getState();if(t){T.logger.debugLog("tusSender.featureDetection: retrieved extensions from server",t);const n=t.split(",");if(n.length&&r.onFeaturesDetected){const t=r.onFeaturesDetected(n);t&&e.updateState(e=>{e.options=Object(T.merge)({},e.options,t)})}else Object.keys(un).forEach(t=>{un[t](n,e)})}n&&n!==e.getState().options.version&&(T.logger.debugLog("tusSender.featureDetection: setting version to server version: "+n),e.updateState(e=>{e.options.version=n})),e.updateState(e=>{e.featureDetection={processed:!0,version:n,extensions:t}})},cn=(e,t,n)=>e.catch(e=>{T.logger.debugLog("tusSender.featureDetection: failed to retrieve data from server",e)}).then(e=>{if(e&&~zt.indexOf(e.status)){const r=e.getResponseHeader("Tus-Extension"),o=e.getResponseHeader("Tus-Resumable");r&&kt.setItem(sn(t),JSON.stringify({extensions:r,versions:o})),dn(n,r,o)}}),ln=(e,t)=>{const{options:n}=t.getState(),r=Object(T.request)(e,null,{method:"OPTIONS",headers:{"tus-resumable":n.version}});return{request:cn(r,e,t),abort:()=>(r.xhr.abort(),!0)}};var fn=(e,t)=>{let n;const{options:r,featureDetection:o}=t.getState();e=r.featureDetectionUrl||e,T.logger.debugLog("tusSender.featureDetection: about to request server info",e);const a=kt.getItem(sn(e));return o.processed||(n=a?((e,t,n)=>{let r;try{var o;if(r=JSON.parse(n),null!==(o=r)&&void 0!==o&&o.extensions){const{extensions:e,version:n}=r;T.logger.debugLog("tusSender.featureDetection: retrieved feature detection data from session storage",r),dn(t,e,n)}else r=null}catch(e){T.logger.debugLog("tusSender.featureDetection: failed to load feature detection data from session storage")}return r||kt.removeItem(sn(e)),r?null:ln(e,t)})(e,t,a):ln(e,t)),n};var pn=(e,t)=>N?(n,r,o,a)=>{let s;if(!r)throw new I($t);if(n.length>1||n[0].url)s=e.send(n,r,o,a);else{T.logger.debugLog("tusSender: sending file using TUS protocol");let u=t.getState().options.featureDetection?fn(r,t):null;const{request:i,abort:d}=((e,t,n,r,o,a,s)=>{let u;const i=()=>{const s=rn(e,t,n,r,o,a);return u=s.abort,s.request};return{request:s?s.request.then(i,i):i(),abort:()=>u?u():(null==s?void 0:s.abort())||!1}})(n,r,o,a,t,e,u);s={request:i,abort:d,senderType:$t}}return s}:U;const gn=e=>(((e=(e=>Object(T.merge)({},jt,e))(e)).sendDataOnCreate||e.parallel)&&e.deferLength&&(T.logger.debugLog("tusSender: turning off deferLength - cannot be used when sendDataOnCreate or parallel is enabled"),e.deferLength=!1),e.chunked=!0,e);var hn=(e,t,n)=>{t=gn(t);const r=ce(t,n),o=((e,t)=>{const{state:n,update:r}=K({options:t,items:{},featureDetection:{extensions:null,version:null,processed:!1}}),o={getState:()=>n,updateState:r};return Object(T.hasWindow)()&&T.logger.isDebugOn()&&(window[`__rpldy_${e.id}_tus_state`]=o),o})(e,t);an(e,o,r);return{send:pn(r,o),getOptions:()=>o.getState().options}},bn=e=>(t,n)=>{const r=hn(t,e,n);return t.update({send:r.send}),t.registerExtension(qt,{getOptions:r.getOptions}),t},mn=bn,Sn=n("EcSs"),En=n.n(Sn),vn=n("cDcd"),On=n.n(vn);const Tn=Symbol.for("rpldy_component");var yn=n("Lrr1");const In=(e,t)=>{let n,r,o=!1;t?n=t:T.logger.debugLog("Uploady context - didn't receive input field ref - waiting for external ref");const a=()=>{var e;return null===(e=n)||void 0===e?void 0:e.current},s=()=>{const e=a();Object(T.invariant)(e,"Uploady - Context. File input isn't available"),e.removeEventListener("change",s);const t=r;r=null,u(e.files,t)},u=(t,n)=>{e.add(t,n)};return Object(yn.d)(),{hasUploader:()=>!!e,getInternalFileInput:()=>(n&&(o=!0),n),setExternalFileInput:e=>{o=!0,n=e},getIsUsingExternalInput:()=>o,showFileUpload:e=>{const t=a();Object(T.invariant)(t,"Uploady - Context. File input isn't available"),r=e,t.removeEventListener("change",s),t.addEventListener("change",s),t.value="",t.click()},upload:u,processPending:t=>{e.upload(t)},clearPending:()=>{e.clearPending()},setOptions:t=>{e.update(t)},getOptions:()=>e.getOptions(),getExtension:t=>e.getExtension(t),abort:t=>{e.abort(t)},abortBatch:t=>{e.abortBatch(t)},on:(t,n)=>e.on(t,n),once:(t,n)=>e.once(t,n),off:(t,n)=>e.off(t,n)}};var An=On.a.createContext(null);var Ln=e=>(Object(T.invariant)(!Object(yn.a)(),"Uploady - Valid UploadyContext not found.\nYou may be using packages of different Uploady versions. <Uploady> and all other packages using the context provider must be of the same version: %s",Object(yn.b)()),Object(T.invariant)(e&&e.hasUploader(),"Uploady - Valid UploadyContext not found. Make sure you render inside <Uploady>"),e);var _n=()=>Ln(Object(vn.useContext)(An));const Rn=(e,t)=>{const n=_n(),{on:r,off:o}=n;Object(vn.useEffect)(()=>(r(e,t),()=>{o(e,t)}),[e,t,r,o])},Cn=(e,t)=>(n,r)=>{const[o,a]=Object(vn.useState)(null),s=Object(vn.useCallback)((e,...o)=>{r&&e.id!==r||(a(t(e,...o)),n&&n(e,...o))},[n,r]);return Rn(e,s),o},Pn=(e,t=!0)=>(n,r)=>{const o=Object(vn.useCallback)((e,...o)=>!n||t&&r&&e.id!==r?void 0:n(e,...o),[n,r]);Rn(e,o)},Dn=(e,t)=>{Object(T.isProduction)()||e||console.warn(t)},wn=e=>{e[Tn]=!0},Un=e=>{var t,n;return!0===e[Tn]||!0===(null===(t=e.target)||void 0===t?void 0:t[Tn])||!0===(null===(n=e.render)||void 0===n?void 0:n[Tn])},kn=Pn(Be.BATCH_ADD,!1),jn=Pn(Be.BATCH_START),Nn=Pn(Be.BATCH_FINISH),Fn=Pn(Be.BATCH_CANCEL),Bn=Pn(Be.BATCH_ABORT),xn=Cn(Be.BATCH_PROGRESS,e=>({...e})),Hn=Pn(Be.ITEM_START),Mn=Pn(Be.ITEM_FINISH),qn=Pn(Be.ITEM_CANCEL),$n=Pn(Be.ITEM_ERROR),zn=Pn(Be.ITEM_ABORT),Gn=Pn(Be.ITEM_FINALIZE),Wn=Cn(Be.ITEM_PROGRESS,e=>({...e})),Vn=Pn(Be.REQUEST_PRE_SEND,!1),Kn=Pn(Be.ALL_ABORT,!1);var Xn=e=>{const t=_n();return e&&t.setOptions(e),t.getOptions()};var Qn=()=>{const e=_n();return Object(vn.useCallback)(t=>e.abort(t),[e])};var Yn=()=>{const e=_n();return Object(vn.useCallback)(t=>e.abortBatch(t),[e])};var Jn=()=>{const e=_n();return Object(vn.useCallback)(()=>e.abort(),[e])};var Zn=e=>{const{listeners:t,debug:n,children:r,inputRef:o,...a}=e;T.logger.setDebug(!!n),T.logger.debugLog("@@@@@@ Uploady Rendering @@@@@@",e);const s=((e,t)=>{const n=Object(vn.useMemo)(()=>(T.logger.debugLog("Uploady creating a new uploader instance",e),At(e)),[e.enhancer]);return n.update(e),Object(vn.useEffect)(()=>(t&&(T.logger.debugLog("Uploady setting event listeners",t),Object.entries(t).forEach(([e,t])=>{n.on(e,t)})),()=>{t&&(T.logger.debugLog("Uploady removing event listeners",t),Object.entries(t).forEach(([e,t])=>n.off(e,t)))}),[t,n]),n})(a,t),u=Object(vn.useMemo)(()=>In(s,o),[s,o]);return On.a.createElement(An.Provider,{value:u},r)},er=e=>t=>{const n=_n(),{id:r}=t,[o,a]=Object(vn.useState)({update:null,data:null});return Object(vn.useLayoutEffect)(()=>{const e=t=>t.items.find(e=>e.id===r)&&new Promise(r=>{a(()=>({update:t=>{n.off(Be.REQUEST_PRE_SEND,e),r(t)},data:t}))});return r&&n.on(Be.REQUEST_PRE_SEND,e),()=>{r&&n.off(Be.REQUEST_PRE_SEND,e)}},[n,r]),On.a.createElement(e,En()({},t,{updateRequest:o.update,requestData:o.data}))},tr=n("faye"),nr=n.n(tr);const rr=(e,t,n)=>On.a.createElement("input",En()({},e,{name:t.inputFieldName,type:"file",ref:n})),or=Object(vn.memo)(Object(vn.forwardRef)(({container:e,noPortal:t,...n},r)=>{const o=Xn(),a=e&&1===e.nodeType;return Object(T.invariant)(a||!Object(T.hasWindow)(),"Uploady - Container for file input must be a valid dom element"),t?rr(n,o,r):((e,t,n,r,o)=>e&&t?nr.a.createPortal(rr(n,r,o),e):null)(e,a,n,o,r)}));var ar=e=>{const{multiple:t=!0,capture:n,accept:r,webkitdirectory:o,children:a,inputFieldContainer:s,customInput:u,fileInputId:i,noPortal:d=!1,...c}=e,l=u?null:s||(Object(T.hasWindow)()?document.body:null),f=Object(vn.useRef)();return On.a.createElement(Zn,En()({},c,{inputRef:f}),u?null:On.a.createElement(or,{container:l,multiple:t,capture:n,accept:r,webkitdirectory:o,style:{display:"none"},ref:f,id:i,noPortal:d}),a)};const sr=e=>{const t=e.closest("form");let n={filesParamName:e.getAttribute("name"),method:void 0,url:void 0};if(t){const e=t.getAttribute("method"),r=(e=>{const t=window.location;let n,r=e.getAttribute("action")||"";switch(r=r.replace(/\s/g,""),!0){case""===r:r=t.href;break;case r.startsWith("/"):r=`${t.protocol}//${t.host}${r}`;break;case!/:\/\//.test(r):n=t.pathname.split("/").slice(0,-1).concat("").join("/"),r=`${t.protocol}//${t.host}${n}${r}`}return r})(t);n.method=e?e.toUpperCase():void 0,n.url=r,T.logger.debugLog(`Uploady.useFileInput: using custom input's parent form url ${n.url} and method ${n.method||""}`)}return n};var ur=e=>{const t=_n();return e&&t.setExternalFileInput(e),Object(vn.useEffect)(()=>{if(null!=e&&e.current&&"closest"in e.current){const n=e.current,r=t.getOptions();if(!r.destination||!r.destination.url){const e=sr(n);t.setOptions({destination:e})}}},[e,t]),e||t.getInternalFileInput()},ir=ar;Dn(N||!Object(T.hasWindow)(),"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var dr=e=>{const{chunked:t,chunkSize:n,retries:r,parallel:o,...a}=e,s=Object(vn.useMemo)(()=>N?((e,t)=>{const n=fe(e);return t?It(n,t):n})({chunked:t,chunkSize:n,retries:r,parallel:o},e.enhancer):void 0,[e.enhancer,t,n,r,o]);return On.a.createElement(ir,En()({},a,{enhancer:s}))};const cr=Pn(X.CHUNK_START,!1),lr=Pn(X.CHUNK_FINISH,!1);var fr=dr;const pr="Uploady - retry was not registered. Make sure you used the enhancer";var gr=()=>{const e=_n().getExtension(Lt);return Object(T.invariant)(e,pr),e.retry},hr=()=>{const e=_n().getExtension(Lt);return Object(T.invariant)(e,pr),e.retryBatch};var br=Pn(_t,!1),mr=Dt;Dn(N,"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var Sr=e=>{const{chunked:t,chunkSize:n,retries:r,parallel:o,version:a,featureDetection:s,featureDetectionUrl:u,onFeaturesDetected:i,resume:d,deferLength:c,overrideMethod:l,sendDataOnCreate:f,storagePrefix:p,lockedRetryDelay:g,forgetOnSuccess:h,ignoreModifiedDateInStorage:b,...m}=e,S=Object(vn.useMemo)(()=>N?((e,t)=>{const n=bn(e);return t?It(n,t):n})({chunked:t,chunkSize:n,retries:r,parallel:o,version:a,featureDetection:s,featureDetectionUrl:u,onFeaturesDetected:i,resume:d,deferLength:c,overrideMethod:l,sendDataOnCreate:f,storagePrefix:p,lockedRetryDelay:g,forgetOnSuccess:h,ignoreModifiedDateInStorage:b},e.enhancer):void 0,[e.enhancer,t,n,r,o,a,s,u,i,d,c,l,f,p,g,h,b]);return On.a.createElement(ir,En()({},m,{enhancer:S}))};var Er=()=>{const e=_n().getExtension(qt);return Object(T.invariant)(e,"Uploady - tus was not registered. Make sure you used the enhancer"),()=>xt(e.getOptions())},vr=Sr;var Or=e=>{const t=(t,n)=>{const{showFileUpload:r}=_n(),{id:o,className:a,text:s,children:u,extraProps:i,onClick:d,...c}=t,l=Object(vn.useRef)();l.current=c;const f=Object(vn.useCallback)(e=>{r(l.current),null==d||d(e)},[r,l,d]);return On.a.createElement(e,En()({ref:n,onClick:f,id:o,className:a,children:u||s||"Upload"},i))};return wn(t),Object(vn.forwardRef)(t)};var Tr=Or(Object(vn.forwardRef)((e,t)=>On.a.createElement("button",En()({ref:t},e)))),yr=Tr,Ir=n("ALC1");const Ar=Object(vn.forwardRef)(({className:e,id:t,children:n,onDragOverClassName:r,dropHandler:o,htmlDirContentParams:a,extraProps:s,...u},i)=>{const{upload:d}=_n(),c=Object(vn.useRef)(null),l=Object(vn.useRef)(!1);Object(vn.useImperativeHandle)(i,()=>c.current,[]);const f=Object(vn.useRef)();f.current=u;const p=Object(vn.useCallback)(()=>{l.current=!1,c.current&&r&&c.current.classList.remove(r)},[r,c]),g=Object(vn.useCallback)(e=>o?Promise.resolve(o(e)):Object(Ir.getFilesFromDragEvent)(e,a||{}),[o,a]),h=Object(vn.useCallback)(e=>{g(e).then(e=>{d(e,f.current)})},[d,g,f]),b=Object(vn.useCallback)(e=>{l.current=!l.current&&e.target===c.current,c.current&&r&&c.current.classList.add(r)},[r,c]),m=Object(vn.useCallback)(e=>{e.preventDefault()},[]),S=Object(vn.useCallback)(e=>{e.preventDefault(),e.persist(),p(),h(e)},[p,h]),E=Object(vn.useCallback)(e=>{l.current&&e.target===c.current&&p()},[p,c]),v=Object(vn.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),p()},[p]);return On.a.createElement("div",En()({id:t,className:e,ref:c,onDragOver:m,onDragEnter:b,onDrop:S,onDragLeave:E,onDragEnd:v},s),n)});wn(Ar);var Lr=Ar,_r=Lr;var Rr=(e,t)=>{const{upload:n}=_n(),r=Object(vn.useRef)();return r.current=e,Object(vn.useCallback)(e=>{var o;const a=null===(o=e.clipboardData)||void 0===o?void 0:o.files;null!=a&&a.length&&(n(a,r.current),null==t||t({count:a.length}))},[n,r,t])};var Cr=e=>Object(vn.forwardRef)((t,n)=>{const{id:r,className:o,children:a,onPasteUpload:s,extraProps:u,...i}=t,d=Rr(i,s),c=Un(e)?{...i,extraProps:{...u,onPaste:d}}:{...u,onPaste:d};return On.a.createElement(e,En()({ref:n,id:r,className:o},c),a)});const Pr=(e,t)=>{((null==e?void 0:e.current)||window).addEventListener("paste",t)},Dr=(e,t)=>{((null==e?void 0:e.current)||window).removeEventListener("paste",t)};var wr=(e,t,n)=>{const r=Object(vn.useRef)(!0),o=Rr(e,n),a=Object(vn.useCallback)(()=>(r.current=!r.current,r.current?Pr(t,o):Dr(t,o),r.current),[t,o]),s=Object(vn.useCallback)(()=>r.current,[]);return Object(vn.useEffect)(()=>(r.current&&Pr(t,o),()=>{r.current&&Dr(t,o)}),[t,o]),{toggle:a,getIsEnabled:s}},Ur=Cr;const kr={IMAGE:"image",VIDEO:"video"},jr=Object(T.devFreeze)({rememberPreviousBatches:!1,loadFirstOnly:!1,maxPreviewImageSize:2e7,maxPreviewVideoSize:1e8,fallbackUrl:"",imageMimeTypes:["image/jpeg","image/webp","image/gif","image/png","image/apng","image/bmp","image/x-icon","image/svg+xml"],videoMimeTypes:["video/mp4","video/webm","video/ogg"],previewComponentProps:void 0}),Nr=(e,t)=>{let n=Object(T.isFunction)(e)?e(t):e;return"string"==typeof n&&(n={id:"",url:n,name:t.name,type:kr.IMAGE}),n},Fr=(e,t,n,r)=>{let o;return t&&~t.indexOf(r.type)&&(!n||r.size<=n)&&(o={url:Mt.a.createObjectURL(r),name:r.name,type:e}),o},Br=(e,t,n)=>{let r,o,a=!1;if(e.file){const n=e.file;r=((e,t)=>{let n=Fr(kr.IMAGE,t.imageMimeTypes,t.maxPreviewImageSize||0,e);return n||(n=Fr(kr.VIDEO,t.videoMimeTypes,t.maxPreviewVideoSize||0,e)),n})(e.file,t),r||(r=Nr(t.fallbackUrl,n),a=!0)}else r={url:e.url,name:e.url,type:kr.IMAGE};if(r){const{url:t,type:a}=r;o=Object(T.isFunction)(n)?n(e,t,a):n}return r&&{...r,id:e.id,isFallback:a,props:o}};var xr=e=>{const[t,n]=Object(vn.useState)([]),r=(o=e,{...jr,...o});var o;const a=Object(vn.useCallback)(()=>{n([])},[]);return jn(o=>{const a=(r.loadFirstOnly?o.items.slice(0,1):o.items).map(t=>Br(t,r,e.previewComponentProps)).filter(Boolean);n(e.rememberPreviousBatches?((e,t)=>{const n=[];return t.forEach(t=>{const r=e.findIndex(e=>e.id===t.id);~r?e.splice(r,1,t):n.push(t)}),e.concat(n)})(t,a):a)}),{previews:t,clearPreviews:a}};var Hr=e=>{const{PreviewComponent:t,previewMethodsRef:n,onPreviewsChanged:r,...o}=e,{previews:a,clearPreviews:s}=xr(o),u=Object(vn.useCallback)(t=>{const n=t.target,r=Nr(e.fallbackUrl,n.src);r&&(n.src=r.url)},[e.fallbackUrl]);return((e,t,n,r)=>{Object(vn.useImperativeHandle)(n,()=>({clear:t}),[t]),Object(vn.useEffect)(()=>{r&&r(e)},[e,r])})(a,s,n,r),a.map(e=>{const{id:n,url:r,type:o,name:a,isFallback:s,props:i}=e;return t?On.a.createElement(t,En()({key:n+r,id:n,url:r,type:o,name:a,isFallback:s},i)):((e,t,n,r)=>e===kr.VIDEO?On.a.createElement("video",En()({key:t,src:t,controls:!0},n)):On.a.createElement("img",En()({key:t,onError:r,src:t},n)))(o,r,i,u)})},Mr=Hr;const qr=Object(vn.forwardRef)((e,t)=>{const n=Object(vn.useRef)(null),r=_n(),{className:o,id:a,placeholder:s,uploadRef:u,validate:i,ignoreKeyPress:d,...c}=e,l=Object(vn.useRef)();l.current=c,Object(vn.useImperativeHandle)(t,()=>n.current,[]);const f=Object(vn.useCallback)(()=>{const e=n.current,t=null==e?void 0:e.value;(i?i(t,e):t)&&r.upload(t,l.current)},[r,i,l,n]),p=Object(vn.useCallback)(e=>{d||"Enter"!==e.key||f()},[f,d]);return Object(vn.useImperativeHandle)(u,()=>f,[f]),On.a.createElement("input",{type:"text",id:a,ref:n,className:o,onKeyPress:p,placeholder:s})});wn(qr);var $r=qr,zr=qr},cDcd:function(t,n){t.exports=e},faye:function(e,n){e.exports=t},"mHo/":function(e,t,n){"use strict";n.r(t),n.d(t,"BATCH_STATES",(function(){return i})),n.d(t,"FILE_STATES",(function(){return d})),n.d(t,"invariant",(function(){return a.a})),n.d(t,"throttle",(function(){return u.a})),n.d(t,"logger",(function(){return r})),n.d(t,"triggerCancellable",(function(){return h})),n.d(t,"triggerUpdater",(function(){return m})),n.d(t,"createBatchItem",(function(){return v})),n.d(t,"request",(function(){return T})),n.d(t,"parseResponseHeaders",(function(){return O})),n.d(t,"isFunction",(function(){return I.a})),n.d(t,"isPlainObject",(function(){return C})),n.d(t,"isSamePropInArrays",(function(){return A})),n.d(t,"devFreeze",(function(){return R})),n.d(t,"merge",(function(){return w})),n.d(t,"getMerge",(function(){return D})),n.d(t,"clone",(function(){return U})),n.d(t,"pick",(function(){return k})),n.d(t,"hasWindow",(function(){return c})),n.d(t,"isProduction",(function(){return _.a}));var r={};n.r(r),n.d(r,"isDebugOn",(function(){return f})),n.d(r,"setDebug",(function(){return p})),n.d(r,"debugLog",(function(){return g}));var o=n("kvau"),a=n.n(o),s=n("uDTZ"),u=n.n(s);const i={PENDING:"pending",ADDED:"added",PROCESSING:"processing",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ABORTED:"aborted"},d={PENDING:"pending",ADDED:"added",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ERROR:"error",ABORTED:"aborted"};var c=()=>"object"==typeof window&&!!window.document;let l;const f=()=>("boolean"!=typeof l&&(l=c()&&("location"in window&&!!~window.location.search.indexOf("rpldy_debug=true")||!0===window["__rpldy-logger-debug__"])),!!l),p=e=>{c()&&(window["__rpldy-logger-debug__"]=e),l=!!e||null},g=(...e)=>{f()&&console.log(...e)};var h=(e,t,...n)=>{const r=(t,...n)=>new Promise((r,o)=>{const a=e(t,...n);a&&a.length?Promise.all(a).catch(o).then(e=>e&&r(!!~e.findIndex(e=>!1===e))):r(!1)});return t?r(t,...n):r};const b=e=>null==e;var m=(e,t,...n)=>{const r=(t,...n)=>new Promise((r,o)=>{const a=e(t,...n);a&&a.length?Promise.all(a).catch(o).then(e=>{let t;if(e)for(;b(t)&&e.length;)t=e.pop();r(b(t)?void 0:t)}):r()});return t?r(t,...n):r};const S=Symbol.for("__rpldy-bi__");let E=0;var v=(e,t,n=!1)=>{E+=e.id&&e.batchId?0:1;let r={id:e.id&&e.batchId?e.id:`${t}.item-${E}`,batchId:t,state:n?d.PENDING:d.ADDED,uploadStatus:0,completed:0,loaded:0,aborted:!1,recycled:!1,previousBatch:null};if(Object.defineProperty(r,S,{value:!0,writable:!0}),"object"==typeof e&&!0===e[S]&&(r.recycled=!0,r.previousBatch=e.batchId,e=e.file||e.url),"string"==typeof e)r=((e,t)=>(e.url=t,e))(r,e);else{if(!(e=>e&&(e instanceof File||e instanceof Blob||"object"==typeof e&&e.name&&e.type))(e))throw new Error("Unknown type of file added: "+typeof e);r=((e,t)=>(e.file=t,e))(r,e)}return r};var O=e=>{let t;try{t=e.getAllResponseHeaders().trim().split(/[\r\n]+/).reduce((e,t)=>{const[n,r]=t.split(": ");return e[n]=r,e},{})}catch(t){g("uploady.request: failed to read response headers",e)}return t},T=(e,t,n={})=>{const r=new XMLHttpRequest,o=new Promise((o,a)=>{r.onerror=()=>a(r),r.ontimeout=()=>a(r),r.onabort=()=>a(r),r.onload=()=>o(r),r.open(n.method||"GET",e),((e,t)=>{t&&Object.keys(t).forEach(n=>{void 0!==t[n]&&e.setRequestHeader(n,t[n])})})(r,n.headers),r.withCredentials=!!n.withCredentials,n.preSend&&n.preSend(r),r.send(t)});return o.xhr=r,o},y=n("r5yn"),I=n.n(y);var A=(e,t,n)=>{let r=!0;const o=(e=>{const t=[].concat(e);return e=>e.map(e=>t.map(t=>e[t]).join())})(n);if(e&&t&&e.length===t.length){const n=o(e),a=o(t);r=!!n.find((e,t)=>e!==a[t])}return!r},L=n("DVTP"),_=n.n(L);var R=e=>_()()?e:Object.freeze(e),C=e=>{var t;return!!e&&"object"==typeof e&&("Object"===(null===(t=Object.getPrototypeOf(e))||void 0===t?void 0:t.constructor.name)||null===Object.getPrototypeOf(e))};const P=e=>C(e)||Array.isArray(e),D=(e={})=>{const t=(n,...r)=>(n&&r.length&&r.forEach(r=>{r&&((e,t)=>{const n=Object.keys(e);return t.withSymbols?n.concat(Object.getOwnPropertySymbols(e)):n})(r,e).forEach(o=>{const a=r[o];e.predicate&&!e.predicate(o,a)||(void 0!==a||e.undefinedOverwrites)&&(P(a)?(void 0!==n[o]&&C(n[o])||(n[o]=Array.isArray(a)?[]:{}),t(n[o],a)):n[o]=a)})}),n);return t};var w=D(),U=(e,t=w)=>P(e)?t(Array.isArray(e)?[]:{},e):e,k=(e,t)=>e&&Object.keys(e).reduce((n,r)=>(~t.indexOf(r)&&(n[r]=e[r]),n),{})},r5yn:function(e,t){e.exports=function(e){return"function"==typeof e}}})}));
//# sourceMappingURL=rpldy-all.umd.min.js.map